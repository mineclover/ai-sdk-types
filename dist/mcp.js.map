{"version":3,"sources":["../src/mcp.ts"],"sourcesContent":["/**\n * MCP (Model Context Protocol) Types\n *\n * Re-exported from @packages/zod-schema with local utilities.\n *\n * @see https://modelcontextprotocol.io/\n */\n\nimport type { OpenAIToolDefinition, ToolSchema } from './tools.js'\n\n// Re-export all MCP types from zod-schema\nexport {\n  type MCPToolAnnotations,\n  type MCPToolDefinition,\n  type MCPResourceDefinition,\n  type MCPPromptArgument,\n  type MCPPromptDefinition,\n  type MCPOAuth2AuthConfig,\n  type MCPAuthConfig,\n  type MCPMetadata,\n  type CollectedToolInfo,\n} from '@packages/zod-schema'\n\nimport type {\n  MCPToolDefinition,\n  MCPMetadata,\n  CollectedToolInfo,\n} from '@packages/zod-schema'\n\n// ============================================\n// Conversion Utilities\n// ============================================\n\n/**\n * Convert MCP tool definition to AI SDK ToolSchema\n */\nexport function mcpToolToSchema(tool: MCPToolDefinition): ToolSchema {\n  return {\n    description: tool.description,\n    inputSchema: tool.inputSchema,\n    outputSchema: tool.outputSchema,\n  }\n}\n\n/**\n * Convert MCP tool definition to OpenAI format\n */\nexport function mcpToolToOpenAI(name: string, tool: MCPToolDefinition): OpenAIToolDefinition {\n  return {\n    type: 'function',\n    function: {\n      name,\n      description: tool.description,\n      parameters: {\n        type: 'object',\n        properties: (tool.inputSchema.properties as Record<string, unknown>) ?? {},\n        required: tool.inputSchema.required,\n      },\n    },\n  }\n}\n\n/**\n * Convert MCP metadata tools to OpenAI format\n */\nexport function mcpMetadataToOpenAITools(metadata: MCPMetadata): OpenAIToolDefinition[] {\n  return metadata.tools.map((tool) => mcpToolToOpenAI(tool.name, tool))\n}\n\n/**\n * Collect tools from multiple MCP metadata sources\n *\n * @param sources - Map of namespace to MCP metadata\n * @returns Collected tool info with OpenAI and AI SDK formats\n */\nexport function collectMCPTools(sources: Record<string, MCPMetadata>): CollectedToolInfo {\n  const openaiTools: OpenAIToolDefinition[] = []\n  const aiTools: Record<string, ToolSchema> = {}\n  const summary: Record<string, number> = {}\n\n  for (const [namespace, metadata] of Object.entries(sources)) {\n    summary[namespace] = metadata.tools.length\n\n    for (const tool of metadata.tools) {\n      const fullName = `${namespace}:${tool.name}`\n\n      // Add to OpenAI format with namespaced name\n      openaiTools.push(mcpToolToOpenAI(fullName, tool))\n\n      // Add to AI SDK format\n      aiTools[fullName] = mcpToolToSchema(tool)\n    }\n  }\n\n  return {\n    openaiTools,\n    aiTools,\n    summary,\n    totalTools: openaiTools.length,\n  }\n}\n"],"mappings":";AAoCO,SAAS,gBAAgB,MAAqC;AACnE,SAAO;AAAA,IACL,aAAa,KAAK;AAAA,IAClB,aAAa,KAAK;AAAA,IAClB,cAAc,KAAK;AAAA,EACrB;AACF;AAKO,SAAS,gBAAgB,MAAc,MAA+C;AAC3F,SAAO;AAAA,IACL,MAAM;AAAA,IACN,UAAU;AAAA,MACR;AAAA,MACA,aAAa,KAAK;AAAA,MAClB,YAAY;AAAA,QACV,MAAM;AAAA,QACN,YAAa,KAAK,YAAY,cAA0C,CAAC;AAAA,QACzE,UAAU,KAAK,YAAY;AAAA,MAC7B;AAAA,IACF;AAAA,EACF;AACF;AAKO,SAAS,yBAAyB,UAA+C;AACtF,SAAO,SAAS,MAAM,IAAI,CAAC,SAAS,gBAAgB,KAAK,MAAM,IAAI,CAAC;AACtE;AAQO,SAAS,gBAAgB,SAAyD;AACvF,QAAM,cAAsC,CAAC;AAC7C,QAAM,UAAsC,CAAC;AAC7C,QAAM,UAAkC,CAAC;AAEzC,aAAW,CAAC,WAAW,QAAQ,KAAK,OAAO,QAAQ,OAAO,GAAG;AAC3D,YAAQ,SAAS,IAAI,SAAS,MAAM;AAEpC,eAAW,QAAQ,SAAS,OAAO;AACjC,YAAM,WAAW,GAAG,SAAS,IAAI,KAAK,IAAI;AAG1C,kBAAY,KAAK,gBAAgB,UAAU,IAAI,CAAC;AAGhD,cAAQ,QAAQ,IAAI,gBAAgB,IAAI;AAAA,IAC1C;AAAA,EACF;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,YAAY,YAAY;AAAA,EAC1B;AACF;","names":[]}